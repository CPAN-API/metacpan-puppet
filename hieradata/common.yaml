---

# Defaults
perl::version: '5.16.2'

metacpan::user: 'metacpan'

# Where we mirror cpan with the rrrclient
# also where cpan.metacpan.org serves from
metacpan::cpan_mirror: '/mnt/lv-cpan'

# We don't want watcher enabled
metacpan::watcher::enable: false

# We don't want to have CPAN synced
metacpan::rrrclient::enable: false

# Elasticsearch basic options
elasticsearch::pkg_version: 1.3.1
elasticsearch::memory: 40

metacpan::websites:
  cpan_static:
    vhost_domain: 'cpan.metacpan.org'
    vhost_html: "%{hiera('metacpan::cpan_mirror')}"
    vhost_ssl: true
    vhost_autoindex: true
    vhost_aliases:
      - "cpan.lo.metacpan.org"
      - "cpan.%{hostname}.metacpan.org"
  metacpan_org:
    path: '/home/metacpan/metacpan.org'
    git_source: 'https://github.com/CPAN-API/metacpan-web.git'
    git_revision: 'master'
    vhost_domain: 'metacpan.org'
    vhost_ssl_only: true
    vhost_bare: true
    vhost_aliases:
      - "lo.metacpan.org"
      - "%{hostname}.metacpan.org"
    proxy_ensure: present
    starman_port: 5001
    starman_workers: 1
  www_redirect:
    vhost_domain: 'www.metacpan.org'
    vhost_bare: true
    vhost_ssl: true
  explorer:
    path: '/home/metacpan/explorer.metacpan.org'
    git_source: 'https://github.com/CPAN-API/metacpan-explorer.git'
    git_revision: 'master'
    vhost_domain: 'explorer.metacpan.org'
    vhost_html: '/home/metacpan/explorer.metacpan.org/build'
    vhost_aliases:
      - "explorer.lo.metacpan.org"
      - "explorer.%{hostname}.metacpan.org"


  # api:
  #   git_enable: absent
  #   path: '/home/metacpan/api.metacpan.org'
  #   git_source: 'https://github.com/CPAN-API/cpan-api.git'
  #   git_revision: 'master'
  #   workers: 1

  # web-socket:
  #   git_enable: absent
  #   path: '/home/metacpan/p5-metacpan-websocket'
  #   git_source: 'https://github.com/CPAN-API/p5-metacpan-websocket.git'
  #   git_revision: 'master'
  #   workers: 1

metacpan::fw_ports:
  http:
    order: 200
    port: 80
    source: '0.0.0.0/0'
  https:
    order: 210
    port: 443
    source: '0.0.0.0/0'
