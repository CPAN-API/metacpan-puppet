<!-- MetaCPAN OSSEC Config -->
<ossec_config>
  <client>
    <server-ip><%= @server_ip %></server-ip>
  </client>

  <syscheck>
    <!-- Syscheck Configuration -->
    <frequency>72000</frequency>
    <scan_on_start>no</scan_on_start>
    <auto_ignore>no</auto_ignore>
    <skip_nfs>yes</skip_nfs>

    <!-- Directories to check  (perform all possible verifications) -->
    <directories check_all="yes" realtime="yes">/etc,/boot</directories>
    <directories check_all="yes" realtime="yes">/bin,/sbin,/usr/bin,/usr/sbin</directories>
    <directories check_all="yes" realtime="yes">/lib,/lib64,/usr/lib,/usr/include</directories>
    <directories check_all="yes" realtime="yes">/root/.ssh</directories>

    <!-- Files/directories to ignore -->
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/hosts.deny</ignore>
    <ignore>/etc/mail/statistics</ignore>
    <ignore>/etc/random-seed</ignore>
    <ignore>/etc/adjtime</ignore>
    <ignore>/etc/httpd/logs</ignore>

  </syscheck>

  <rootcheck>
	<!-- Rootcheck Configuration -->
    <frequency>86400</frequency>
	<skip_nfs>yes</skip_nfs>
    <check_ports>no</check_ports>

    <rootkit_files>/var/ossec/etc/shared/rootkit_files.txt</rootkit_files>
    <rootkit_trojans>/var/ossec/etc/shared/rootkit_trojans.txt</rootkit_trojans>
  </rootcheck>

  <!-- Active Response Configs -->
  <command>
    <name>host-deny</name>
    <executable>host-deny.sh</executable>
    <expect>srcip</expect>
    <timeout_allowed>yes</timeout_allowed>
  </command>

  <command>
    <name>firewall-drop</name>
    <executable>firewall-drop.sh</executable>
    <expect>srcip</expect>
    <timeout_allowed>yes</timeout_allowed>
  </command>

  <command>
    <name>disable-account</name>
    <executable>disable-account.sh</executable>
    <expect>user</expect>
    <timeout_allowed>yes</timeout_allowed>
  </command>

  <!-- Files to monitor (localfiles) -->

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/messages</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/authlog</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/secure</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/xferlog</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/maillog</location>
  </localfile>
<% @logfiles.each do |logfile| -%>

  <localfile>
    <log_format>syslog</log_format>
    <location><%= logfile %></location>
  </localfile>
<% end -%>

</ossec_config>
